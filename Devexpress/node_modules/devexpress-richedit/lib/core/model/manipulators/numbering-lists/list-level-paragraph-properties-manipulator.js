"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var list_level_paragraph_property_changed_1 = require("../../changes/model/list/list-level-paragraph-property-changed");
var document_model_1 = require("../../document-model");
var history_item_state_1 = require("../../history/states/history-item-state");
var history_item_state_object_1 = require("../../history/states/history-item-state-object");
var json_paragraph_enums_1 = require("../../json/enums/json-paragraph-enums");
var list_level_1 = require("../../numbering-lists/list-level");
var paragraph_properties_1 = require("../../paragraph/paragraph-properties");
var base_manipulator_1 = require("../base-manipulator");
var ListLevelParagraphPropertiesManipulator = (function (_super) {
    tslib_1.__extends(ListLevelParagraphPropertiesManipulator, _super);
    function ListLevelParagraphPropertiesManipulator(manipulator) {
        var _this = _super.call(this, manipulator) || this;
        _this.align = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.Alignment, paragraph_properties_1.ParagraphPropertiesMask.UseAlignment, function (properties, value) { return properties.alignment = value; }, function (properties) { return properties.alignment; });
        _this.contextualSpacing = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.ContextualSpacing, paragraph_properties_1.ParagraphPropertiesMask.UseContextualSpacing, function (properties, value) { return properties.contextualSpacing = value; }, function (properties) { return properties.contextualSpacing; });
        _this.afterAutoSpacing = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.AfterAutoSpacing, paragraph_properties_1.ParagraphPropertiesMask.UseAfterAutoSpacing, function (properties, value) { return properties.afterAutoSpacing = value; }, function (properties) { return properties.afterAutoSpacing; });
        _this.shadingInfo = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.ShadingInfo, paragraph_properties_1.ParagraphPropertiesMask.UseShadingInfoIndex, function (properties, value) { return properties.shadingInfo = value; }, function (properties) { return properties.shadingInfo; });
        _this.beforeAutoSpacing = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.BeforeAutoSpacing, paragraph_properties_1.ParagraphPropertiesMask.UseBeforeAutoSpacing, function (properties, value) { return properties.beforeAutoSpacing = value; }, function (properties) { return properties.beforeAutoSpacing; });
        _this.firstLineIndent = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.FirstLineIndent, paragraph_properties_1.ParagraphPropertiesMask.UseFirstLineIndent, function (properties, value) { return properties.firstLineIndent = value; }, function (properties) { return properties.firstLineIndent; });
        _this.keepLinesTogether = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.KeepLinesTogether, paragraph_properties_1.ParagraphPropertiesMask.UseKeepLinesTogether, function (properties, value) { return properties.keepLinesTogether = value; }, function (properties) { return properties.keepLinesTogether; });
        _this.firstLineIndentType = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.FirstLineIndentType, paragraph_properties_1.ParagraphPropertiesMask.UseFirstLineIndent, function (properties, value) { return properties.firstLineIndentType = value; }, function (properties) { return properties.firstLineIndentType; });
        _this.leftIndent = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.LeftIndent, paragraph_properties_1.ParagraphPropertiesMask.UseLeftIndent, function (properties, value) { return properties.leftIndent = value; }, function (properties) { return properties.leftIndent; });
        _this.lineSpacing = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.LineSpacing, paragraph_properties_1.ParagraphPropertiesMask.UseLineSpacing, function (properties, value) { return properties.lineSpacing = value; }, function (properties) { return properties.lineSpacing; });
        _this.lineSpacingType = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.LineSpacingType, paragraph_properties_1.ParagraphPropertiesMask.UseLineSpacing, function (properties, value) { return properties.lineSpacingType = value; }, function (properties) { return properties.lineSpacingType; });
        _this.outlineLevel = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.OutlineLevel, paragraph_properties_1.ParagraphPropertiesMask.UseOutlineLevel, function (properties, value) { return properties.outlineLevel = value; }, function (properties) { return properties.outlineLevel; });
        _this.pageBreakBefore = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.PageBreakBefore, paragraph_properties_1.ParagraphPropertiesMask.UsePageBreakBefore, function (properties, value) { return properties.pageBreakBefore = value; }, function (properties) { return properties.pageBreakBefore; });
        _this.rightIndent = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.RightIndent, paragraph_properties_1.ParagraphPropertiesMask.UseRightIndent, function (properties, value) { return properties.rightIndent = value; }, function (properties) { return properties.rightIndent; });
        _this.spacingAfter = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.SpacingAfter, paragraph_properties_1.ParagraphPropertiesMask.UseSpacingAfter, function (properties, value) { return properties.spacingAfter = value; }, function (properties) { return properties.spacingAfter; });
        _this.spacingBefore = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.SpacingBefore, paragraph_properties_1.ParagraphPropertiesMask.UseSpacingBefore, function (properties, value) { return properties.spacingBefore = value; }, function (properties) { return properties.spacingBefore; });
        _this.suppressHyphenation = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.SuppressHyphenation, paragraph_properties_1.ParagraphPropertiesMask.UseSuppressHyphenation, function (properties, value) { return properties.suppressHyphenation = value; }, function (properties) { return properties.suppressHyphenation; });
        _this.suppressLineNumbers = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.SuppressLineNumbers, paragraph_properties_1.ParagraphPropertiesMask.UseSuppressLineNumbers, function (properties, value) { return properties.suppressLineNumbers = value; }, function (properties) { return properties.suppressLineNumbers; });
        _this.widowOrphanControl = new ParagraphPropertiesManipulator(manipulator, json_paragraph_enums_1.JSONParagraphFormattingProperty.WidowOrphanControl, paragraph_properties_1.ParagraphPropertiesMask.UseWidowOrphanControl, function (properties, value) { return properties.widowOrphanControl = value; }, function (properties) { return properties.widowOrphanControl; });
        return _this;
    }
    return ListLevelParagraphPropertiesManipulator;
}(base_manipulator_1.BaseManipulator));
exports.ListLevelParagraphPropertiesManipulator = ListLevelParagraphPropertiesManipulator;
var ParagraphPropertiesManipulator = (function (_super) {
    tslib_1.__extends(ParagraphPropertiesManipulator, _super);
    function ParagraphPropertiesManipulator(manipulator, jsonParagraphFormattingProperty, paragraphPropertiesMask, setProperty, getProperty) {
        var _this = _super.call(this, manipulator) || this;
        _this.paragraphPropertiesMask = paragraphPropertiesMask;
        _this.jsonParagraphFormattingProperty = jsonParagraphFormattingProperty;
        _this.setProperty = setProperty;
        _this.getProperty = getProperty;
        return _this;
    }
    ParagraphPropertiesManipulator.prototype.setValue = function (model, isAbstractList, listIndex, listLevelIndex, newValue, newUse) {
        var newState = new history_item_state_1.HistoryItemState();
        var oldState = new history_item_state_1.HistoryItemState();
        var numberingList = isAbstractList ? model.abstractNumberingLists[listIndex] : model.numberingLists[listIndex];
        var listLevel = numberingList.levels[listLevelIndex];
        var properties = listLevel.getParagraphProperties();
        if (listLevel instanceof list_level_1.NumberingListReferenceLevel) {
            var abstractNumberingListIndex = numberingList.abstractNumberingListIndex;
            oldState.register(new history_item_state_object_1.HistoryItemListLevelUseStateObject(true, abstractNumberingListIndex, listLevelIndex, this.getProperty(properties), properties.getUseValue(this.paragraphPropertiesMask)));
            this.setValueCore(listLevel, newValue, newUse);
            newState.register(new history_item_state_object_1.HistoryItemListLevelUseStateObject(true, abstractNumberingListIndex, listLevelIndex, newValue, newUse));
        }
        else {
            oldState.register(new history_item_state_object_1.HistoryItemListLevelUseStateObject(isAbstractList, listIndex, listLevelIndex, this.getProperty(properties), properties.getUseValue(this.paragraphPropertiesMask)));
            this.setValueCore(listLevel, newValue, newUse);
            newState.register(new history_item_state_object_1.HistoryItemListLevelUseStateObject(isAbstractList, listIndex, listLevelIndex, newValue, newUse));
        }
        this.model.resetMergedFormattingCache(document_model_1.ResetFormattingCacheType.Paragraph);
        this.modelManipulator.notifyModelChanged(new list_level_paragraph_property_changed_1.ListLevelParagraphPropertyChangedModelChange(this.jsonParagraphFormattingProperty, newState));
        return oldState;
    };
    ParagraphPropertiesManipulator.prototype.restoreValue = function (model, state) {
        var stateObject = state.objects[0];
        var numberingList = stateObject.isAbstractNumberingList ? model.abstractNumberingLists[stateObject.numberingListIndex] : model.numberingLists[stateObject.numberingListIndex];
        var listLevel = numberingList.levels[stateObject.listLevelIndex];
        this.setValueCore(listLevel, stateObject.value, stateObject.use);
        this.model.resetMergedFormattingCache(document_model_1.ResetFormattingCacheType.Paragraph);
        this.modelManipulator.notifyModelChanged(new list_level_paragraph_property_changed_1.ListLevelParagraphPropertyChangedModelChange(this.jsonParagraphFormattingProperty, state));
    };
    ParagraphPropertiesManipulator.prototype.setValueCore = function (level, newValue, newUse) {
        var properties = level.getParagraphProperties().clone();
        this.setProperty(properties, newValue);
        properties.setUseValue(this.paragraphPropertiesMask, newUse);
        level.setParagraphProperties(properties);
        level.onParagraphPropertiesChanged();
    };
    return ParagraphPropertiesManipulator;
}(base_manipulator_1.BaseManipulator));
