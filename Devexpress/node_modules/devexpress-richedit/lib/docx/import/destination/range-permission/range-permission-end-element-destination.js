"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var range_permission_element_destination_1 = require("./range-permission-element-destination");
var RangePermissionEndElementDestination = (function (_super) {
    tslib_1.__extends(RangePermissionEndElementDestination, _super);
    function RangePermissionEndElementDestination() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RangePermissionEndElementDestination.prototype.assignRangePermissionProperties = function (range, _reader) {
        range.end = this.data.subDocumentInfo.positionImporter.currPosition;
        if (!this.data.subDocumentInfo.tableImporter.isInsideTable && !range.table)
            return;
        var table = this.data.subDocumentInfo.tableStack.last;
        if (this.data.subDocumentInfo.tableImporter.isInsideTable && range.table !== table) {
            range.table = table;
            range.firstRowIndex = 0;
        }
        range.lastRowIndex = this.getLastRowIndexFromTable(range.table);
    };
    return RangePermissionEndElementDestination;
}(range_permission_element_destination_1.RangePermissionElementDestination));
exports.RangePermissionEndElementDestination = RangePermissionEndElementDestination;
